{
  "title": "curlで取得したshellスクリプトに引数を渡して実行したい",
  "link": "https://note.com/nomuragoro/n/n2f9fbda4af46",
  "pub_date": "Wed, 29 Jul 2020 17:42:44 +0900",
  "creator": "中 翔（のむらごろう）| IT教育の効果的な受講方法の案内人",
  "guid": "n2f9fbda4af46",
  "description": null,
  "post_id": 27,
  "content": "<figure name=\"8fc3a3ec-d5fb-422a-b680-b8fd156252fe\"><img src=\"/assets/n2f9fbda4af46_3706d195320f02c583d97f74657e4eff.png\"><figcaption></figcaption></figure><p name=\"YpipV\">いちいち長ったらしいコマンドオプションを使うのが面倒くさいので、普段は`~/run.sh`みたいなファイルを作って実行しています。<br>が、この方法はローカル環境で完結してしまうので、この度WSL2に上げた記念に今年リリースされた新しいディストリビューションを入れたので、環境を気にせずに使う方法はないか考えたところ、curlで取得して実行すれば解決できました。</p><p name=\"OhdwP\">この記事では、引数を渡して環境に依存しないように実行する方法を記しています。</p><h2 name=\"BtUvc\"># 対象者</h2><p name=\"bMQZV\">・コマンドコンソールに抵抗がない<br>・複数の環境でshellコマンドを実行したい（環境移行など）</p><h2 name=\"Nwd52\"># 使ってみる</h2><p name=\"2AiI5\">GitHubアカウントがあれば普通にshファイルを作るだけです。<br>今回は拙作の<a href=\"https://github.com/shimajima-eiji/Chocolatey/blob/master/wsl/update_CHANGELOG.sh\" target=\"_blank\">update_CHANGELOG.sh</a>を用いて説明します。</p><h2 name=\"Xr04B\">## github-changesをインストールする</h2><p name=\"BIh0c\">`npm install github-changes`でインストールできます。</p><p name=\"fdc3f25c-2374-4cb3-9bcc-654b6e43f16a\"><a href=\"https://github.com/lalitkapoor/github-changes\">https://github.com/lalitkapoor/github-changes</a></p><p name=\"IYSaQ\">`github-changes -h`が実行できれば大丈夫です。</p><h2 name=\"LvrNX\">## curlで実行する</h2><p name=\"0LZPI\">`curl -sf <a href=\"https://raw.githubusercontent.com/shimajima-eiji/Chocolatey/master/wsl/update_CHANGELOG.sh\" target=\"_blank\">https://raw.githubusercontent.com/shimajima-eiji/Chocolatey/master/wsl/update_CHANGELOG.sh</a> | sh -s -- （ここにオプション）`<br>を実施します。<br>オプションはソースコードのcase文を参照してください。</p><p name=\"fCMx3\">試しに、</p><p name=\"RILft\">`curl -sf <a href=\"https://raw.githubusercontent.com/shimajima-eiji/Chocolatey/master/wsl/update_CHANGELOG.sh\" target=\"_blank\">https://raw.githubusercontent.com/shimajima-eiji/Chocolatey/master/wsl/update_CHANGELOG.sh</a> | sh -s -- -s Chocolatey`<br></p><p name=\"xhkYi\">としてみてください。<br>カレントディレクトリ（./）にCHANGELOG.mdが生成され、&nbsp;<a href=\"https://github.com/shimajima-eiji/Chocolatey/blob/master/CHANGELOG.md\" target=\"_blank\">https://github.com/shimajima-eiji/Chocolatey/blob/master/CHANGELOG.md</a>&nbsp;の内容が得られていると思います。<br>タイミングによっては、ちょっと多いかもしれませんね。</p><h2 name=\"gjCv1\">## 解説：update_changelog.sh</h2><p name=\"sblbG\">通常、-oと-rを引数に与えれば適切に処理されるようにしています。<br><b>-sはこれの簡略系</b>で、リポジトリ（とアカウント名）を指定することで同じ振る舞いをします。</p><h2 name=\"eQ1OA\">## 解説：curlで実行</h2><p name=\"eQiIm\">`curl (url) | sh -s`でダウンロードしたshellコマンドが実行できます。<br>これに引数を与えるのが、`--`です。</p><p name=\"lXcG5\">shコマンドで実行する引数は`--`まで、以降は実行されるコマンドへの引数になります。<br>なので、`-s`が２つあっても双方に適切に処理された、ということです。</p><h2 name=\"dXZgX\"># 反省</h2><p name=\"a5NOC\">やっていることは、github-changesに所定のオプションをつけて実行させているだけですので、ゴテゴテやらなければ普通に手打ちした方が楽です。<br>あくまで「様々な環境で共通に使えるようにしたい」というのが目的です。</p><p name=\"y193j\">とはいえ、curlコマンドのアドレスを忘れてしまったら結局意味がないので、github-changesのオプションを覚えていればわざわざこういう手間を掛ける必要もないので、頑張り方が違うだけですね。</p>",
  "post_date": "2020-07-29 17:42:44",
  "status": "publish",
  "source": "xml"
}